<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute spillover matrix — computeSpillmat • CATALYST</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Compute spillover matrix — computeSpillmat" />

<meta property="og:description" content="Computes a spillover matrix from a priori 
identified single-positive populations." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-54095998-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54095998-3');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CATALYST</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Release version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/differential_analysis.html">Differential analysis with CATALYST</a>
    </li>
    <li>
      <a href="../articles/preprocessing.html">Preprocessing with CATALYST</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/HelenaLC/CATALYST">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://www.imls.uzh.ch/en/research/robinson.html">Robinson Lab</a>
</li>
<li>
  <a href="http://www.bodenmillerlab.org">Bodenmiller Lab</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute spillover matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/HelenaLC/CATALYST/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/HelenaLC/CATALYST/blob/master/R/computeSpillmat.R'><code>R/computeSpillmat.R</code></a></small>
    <div class="hidden name"><code>computeSpillmat.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes a spillover matrix from a priori 
identified single-positive populations.</p>
    
    </div>

    <pre class="usage"><span class='fu'>computeSpillmat</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S4 method for dbFrame</span>
<span class='fu'>computeSpillmat</span>(<span class='no'>x</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"default"</span>,
  <span class='kw'>interactions</span> <span class='kw'>=</span> <span class='st'>"default"</span>, <span class='kw'>trim</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>th</span> <span class='kw'>=</span> <span class='fl'>1e-05</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='dbFrame-class.html'>dbFrame</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code>"default"</code> or <code>"classic"</code>. Specifies the function
to be used for spillover estimation (see below for details).</p></td>
    </tr>
    <tr>
      <th>interactions</th>
      <td><p><code>"default"</code> or <code>"all"</code>. Specifies which interactions spillover 
should be estimated for. The default exclusively takes into consideration 
interactions that are sensible from a chemical and physical point of view
(see below for more details).</p></td>
    </tr>
    <tr>
      <th>trim</th>
      <td><p>numeric. Specifies the trim value used for estimation of spill values. 
Note that <code>trim = 0.5</code> is equivalent to using medians.</p></td>
    </tr>
    <tr>
      <th>th</th>
      <td><p>single non-negative numeric. Specifies the threshold value 
below which spill estimates will be set to 0.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a square compensation matrix with dimensions and dimension names 
matching those of the input flowFrame. Spillover is assumed to be linear,
and, on the basis of their additive nature, spillover values are computed 
independently for each interacting pair of channels.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>default</code> method estimates the spillover as the median ratio 
between the unstained spillover receiving and the stained spillover 
emitting channel in the corresponding single stained populations.</p>
<p><code>method = "classic"</code> will compute the slope of a line through 
the medians (or trimmed means) of stained and unstained populations. 
The medians (or trimmed means) computed from events that are i) negative 
in the respective channels; and, ii) not assigned to interacting channels; 
and, iii) not unassigned are subtracted as to account for background.</p>
<p><code>interactions="default"</code> considers only expected interactions, that is, 
M+/-1 (detection sensitivity), M+16 (oxide formation) and channels measuring 
metals that are potentially contaminated by isotopic impurites 
(see reference below and <code><a href='data.html'>isotope_list</a></code>).</p>
<p><code>interaction="all"</code> will estimate spill for all n x n - n 
interactions, where n denotes the number of single-color controls 
(= <code>nrow(bc_key(re))</code>).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Coursey, J.S., Schwab, D.J., Tsai, J.J., Dragoset, R.A. (2015).
Atomic weights and isotopic compositions, 
(available at http://physics.nist.gov/Comp).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># get single-stained control samples</span>
<span class='fu'><a href='data.html'>data</a></span>(<span class='no'>ss_exp</span>)
<span class='co'># specify mass channels stained for</span>
<span class='no'>bc_ms</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>139</span>, <span class='fl'>141</span>:<span class='fl'>156</span>, <span class='fl'>158</span>:<span class='fl'>176</span>)
<span class='co'># debarcode single-positive populations</span>
<span class='no'>re</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='assignPrelim.html'>assignPrelim</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>ss_exp</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>bc_ms</span>)</div><div class='output co'>#&gt; <span class='message'>Debarcoding data...</span></div><div class='output co'>#&gt; <span class='message'> o ordering</span></div><div class='output co'>#&gt; <span class='message'> o classifying events</span></div><div class='output co'>#&gt; <span class='message'>Normalizing...</span></div><div class='output co'>#&gt; <span class='message'>Computing deltas...</span></div><div class='output co'>#&gt; <span class='message'>Computing counts and yields...</span></div><div class='input'><span class='no'>re</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='estCutoffs.html'>estCutoffs</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>re</span>)
<span class='no'>re</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='applyCutoffs.html'>applyCutoffs</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>re</span>)
<span class='fu'>head</span>(<span class='fu'>computeSpillmat</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>re</span>))</div><div class='output co'>#&gt;         Ba138Di La139Di Ce140Di Pr141Di      Nd142Di     Nd143Di     Nd144Di
#&gt; La139Di       0       1       0       0 0.0000000000 0.000000000 0.000000000
#&gt; Pr141Di       0       0       0       1 0.0000000000 0.000000000 0.000000000
#&gt; Nd142Di       0       0       0       0 1.0000000000 0.002808940 0.002129988
#&gt; Nd143Di       0       0       0       0 0.0071873477 1.000000000 0.019541981
#&gt; Nd144Di       0       0       0       0 0.0015914046 0.001673608 1.000000000
#&gt; Nd145Di       0       0       0       0 0.0004118663 0.000000000 0.009585120
#&gt;              Nd145Di      Nd146Di Sm147Di Nd148Di Sm149Di Nd150Di Eu151Di
#&gt; La139Di 0.0000000000 0.0000000000       0       0       0       0       0
#&gt; Pr141Di 0.0000000000 0.0000000000       0       0       0       0       0
#&gt; Nd142Di 0.0000000000 0.0000000000       0       0       0       0       0
#&gt; Nd143Di 0.0006470948 0.0005555652       0       0       0       0       0
#&gt; Nd144Di 0.0161924880 0.0043906441       0       0       0       0       0
#&gt; Nd145Di 1.0000000000 0.0382795637       0       0       0       0       0
#&gt;         Sm152Di Eu153Di Sm154Di    Gd155Di Gd156Di  Gd157Di    Gd158Di
#&gt; La139Di       0       0       0 0.01275737       0 0.000000 0.00000000
#&gt; Pr141Di       0       0       0 0.00000000       0 0.017408 0.00000000
#&gt; Nd142Di       0       0       0 0.00000000       0 0.000000 0.01608804
#&gt; Nd143Di       0       0       0 0.00000000       0 0.000000 0.00000000
#&gt; Nd144Di       0       0       0 0.00000000       0 0.000000 0.00000000
#&gt; Nd145Di       0       0       0 0.00000000       0 0.000000 0.00000000
#&gt;            Tb159Di    Gd160Di    Dy161Di Dy162Di Dy163Di Dy164Di Ho165Di
#&gt; La139Di 0.00000000 0.00000000 0.00000000       0       0       0       0
#&gt; Pr141Di 0.00000000 0.00000000 0.00000000       0       0       0       0
#&gt; Nd142Di 0.00000000 0.00000000 0.00000000       0       0       0       0
#&gt; Nd143Di 0.01568712 0.00000000 0.00000000       0       0       0       0
#&gt; Nd144Di 0.00000000 0.01812179 0.00000000       0       0       0       0
#&gt; Nd145Di 0.00000000 0.00000000 0.01682198       0       0       0       0
#&gt;         Er166Di Er167Di Er168Di Tm169Di Er170Di Yb171Di Yb172Di Yb173Di Yb174Di
#&gt; La139Di       0       0       0       0       0       0       0       0       0
#&gt; Pr141Di       0       0       0       0       0       0       0       0       0
#&gt; Nd142Di       0       0       0       0       0       0       0       0       0
#&gt; Nd143Di       0       0       0       0       0       0       0       0       0
#&gt; Nd144Di       0       0       0       0       0       0       0       0       0
#&gt; Nd145Di       0       0       0       0       0       0       0       0       0
#&gt;         Lu175Di Yb176Di
#&gt; La139Di       0       0
#&gt; Pr141Di       0       0
#&gt; Nd142Di       0       0
#&gt; Nd143Di       0       0
#&gt; Nd144Di       0       0
#&gt; Nd145Di       0       0</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Helena Lucia Crowell <a href='mailto:crowellh@student.ethz.ch'>crowellh@student.ethz.ch</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Helena L. Crowell, Vito R.T. Zanotelli, Stéphane Chevrier, Mark D. Robinson, Bernd Bodenmiller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

