<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of distance separation cutoffs — estCutoffs • CATALYST</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Estimation of distance separation cutoffs — estCutoffs" />

<meta property="og:description" content="For each sample, estimates a cutoff parameter for the 
distance between positive and negative barcode populations." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-54095998-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54095998-3');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CATALYST</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Release version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/differential_analysis.html">Differential analysis with CATALYST</a>
    </li>
    <li>
      <a href="../articles/preprocessing.html">Preprocessing with CATALYST</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/HelenaLC/CATALYST">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://www.imls.uzh.ch/en/research/robinson.html">Robinson Lab</a>
</li>
<li>
  <a href="http://www.bodenmillerlab.org">Bodenmiller Lab</a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of distance separation cutoffs</h1>
    <small class="dont-index">Source: <a href='https://github.com/HelenaLC/CATALYST/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/HelenaLC/CATALYST/blob/master/R/estCutoffs.R'><code>R/estCutoffs.R</code></a></small>
    <div class="hidden name"><code>estCutoffs.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>For each sample, estimates a cutoff parameter for the 
distance between positive and negative barcode populations.</p>
    
    </div>

    <pre class="usage"><span class='fu'>estCutoffs</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S4 method for dbFrame</span>
<span class='fu'>estCutoffs</span>(<span class='no'>x</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='dbFrame-class.html'>dbFrame</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optional arguments.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Will update the <code>sep_cutoffs</code> slot of the input <code><a href='dbFrame-class.html'>dbFrame</a></code> 
and return the latter.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the estimation of cutoff parameters, we considered yields
upon debarcoding as a function of the applied cutoffs. 
Commonly, this function will be characterized by an initial weak decline, 
where doublets are excluded, and subsequent rapid decline in yields to zero. 
In between, low numbers of counts with intermediate barcode separation 
give rise to a plateau. As an adequate cutoff estimate, 
we target the point that approximately marks the end of the plateau regime 
and the onset of yield decline. To facilitate robust cutoff estimation, 
we fit a linear and a three-parameter log-logistic function 
to the yields function:
$$f(x)=\frac{d}{1+e^{b(log(x)-log(e))}}$$
The goodness of the linear fit relative to the log-logistic fit 
is weighed with:
$$w=\frac{RSS_{log-logistic}}{RSS_{log-logistic}+RSS_{linear}}$$
and the cutoffs for both functions are defined as:
$$c_{linear}=-\frac{\beta_0}{2\beta_1}$$
$$c_{log-logistic}=argmin_x\{\frac{\vert f'(x)\vert}{
f(x)}&gt;0.1\}$$
The final cutoff estimate is defined as the weighted mean 
between these estimates:
$$c=(1-w)\cdot c_{log-logistic}+w\cdot c_{linear}$$</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Finney, D.J. (1971). Probit Analsis. 
<em>Journal of Pharmaceutical Sciences</em> <b>60</b>, 1432.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='data.html'>data</a></span>(<span class='no'>sample_ff</span>, <span class='no'>sample_key</span>)
<span class='co'># assign preliminary IDs</span>
<span class='no'>re</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='assignPrelim.html'>assignPrelim</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>sample_ff</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>sample_key</span>)</div><div class='output co'>#&gt; <span class='message'>Debarcoding data...</span></div><div class='output co'>#&gt; <span class='message'> o ordering</span></div><div class='output co'>#&gt; <span class='message'> o classifying events</span></div><div class='output co'>#&gt; <span class='message'>Normalizing...</span></div><div class='output co'>#&gt; <span class='message'>Computing deltas...</span></div><div class='output co'>#&gt; <span class='message'>Computing counts and yields...</span></div><div class='input'><span class='co'># estimate separation cutoffs</span>
<span class='no'>re</span> <span class='kw'>&lt;-</span> <span class='fu'>estCutoffs</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>re</span>)
<span class='co'># view exemplary estimate</span>
<span class='fu'><a href='plotYields.html'>plotYields</a></span>(<span class='no'>re</span>, <span class='st'>"A1"</span>)</div><div class='output co'>#&gt; <span class='message'>We recommend that you use the dev version of ggplot2 with `ggplotly()`</span>
#&gt; <span class='message'>Install it with: `devtools::install_github('hadley/ggplot2')`</span></div><div class='output co'>#&gt; [[1]]
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Helena Lucia Crowell <a href='mailto:crowellh@student.ethz.ch'>crowellh@student.ethz.ch</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Helena L. Crowell, Vito R.T. Zanotelli, Stéphane Chevrier, Mark D. Robinson, Bernd Bodenmiller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

